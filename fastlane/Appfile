# fastlane/Appfile
# Environment-driven configuration for iOS/App Store Connect

app_identifier(ENV.fetch("IOS_BUNDLE_IDENTIFIER", "com.yourcompany.qrscanner"))
apple_id(ENV.fetch("APPLE_ID", "your-email@example.com"))

# Apple Developer Portal team (Certificates, Identifiers & Profiles)
if ENV["APPLE_TEAM_ID"] || ENV["FASTLANE_TEAM_ID"]
  team_id(ENV["APPLE_TEAM_ID"] || ENV["FASTLANE_TEAM_ID"]) 
end

# App Store Connect team (to avoid team prompt)
if ENV["FASTLANE_ITC_TEAM_ID"] || ENV["FASTLANE_ITC_TEAM_NAME"]
  itc_team_id(ENV["FASTLANE_ITC_TEAM_ID"]) if ENV["FASTLANE_ITC_TEAM_ID"]
  itc_team_name(ENV["FASTLANE_ITC_TEAM_NAME"]) if ENV["FASTLANE_ITC_TEAM_NAME"]
end

# Optional: App Store Connect API key (preferred in CI)
if ENV["ASC_KEY_PATH"] && ENV["ASC_KEY_ID"] && ENV["ASC_ISSUER_ID"]
  app_store_connect_api_key(
    key_id: ENV["ASC_KEY_ID"],
    issuer_id: ENV["ASC_ISSUER_ID"],
    key_filepath: ENV["ASC_KEY_PATH"],
    duration: 1200,
    in_house: false
  )
end
